<!doctype html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Kalendarz adwentowy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #0f172a;
      --card-front: #1e293b;
      --card-front-hover: #334155;
      --accent: #f97316;
      --accent-soft: rgba(248, 164, 76, 0.18);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --locked: #4b5563;
      --open-border: #22c55e;
      --shadow-soft: 0 12px 30px rgba(15, 23, 42, 0.6);
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, #111827 0, #020617 60%);
      color: var(--text-main);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 12px;
    }

    .app {
      width: 100%;
      max-width: 480px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    header {
      text-align: center;
    }

    header h1 {
      margin: 0;
      font-size: 1.5rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    header p {
      margin: 4px 0 0;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .calendar-wrapper {
      position: relative;
      background: radial-gradient(circle at top, #111827, #020617);
      padding: 10px;
      border-radius: 18px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(148, 163, 184, 0.2);
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 6px;
      aspect-ratio: 3 / 2; /* 6x4 = 3:2, ≈Çadnie na telefonie */
    }

    @media (max-width: 420px) {
      .calendar-grid {
        gap: 4px;
      }
    }

    .card {
      position: relative;
      width: 100%;
      height: 100%;
      border: none;
      padding: 0;
      background: transparent;
      perspective: 900px;
      cursor: pointer;
    }

    .card.locked {
      cursor: not-allowed;
    }

    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
      border-radius: 10px;
    }

    .card.is-open .card-inner {
      transform: rotateY(180deg);
    }

    .card-face {
      position: absolute;
      inset: 0;
      backface-visibility: hidden;
      border-radius: 10px;
      overflow: hidden;
    }

    .card-front {
      background: radial-gradient(circle at top, #1f2937, #020617);
      border: 1px solid rgba(148, 163, 184, 0.25);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: background 0.2s, transform 0.2s, box-shadow 0.2s;
    }

    .card:not(.locked):not(.is-open):hover .card-front {
      background: var(--card-front-hover);
      box-shadow: 0 10px 18px rgba(15, 23, 42, 0.9);
      transform: translateY(-1px);
    }

    .card.locked .card-front {
      background: #020617;
      border-style: dashed;
      border-color: rgba(107, 114, 128, 0.8);
      opacity: 0.7;
    }

    .day-number {
      font-size: 1.2rem;
      font-weight: 700;
    }

    .card.locked .day-number {
      color: var(--locked);
    }

    .label {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 0.13em;
      color: var(--text-muted);
    }

    .available-pill {
      padding: 2px 6px;
      border-radius: 999px;
      background: var(--accent-soft);
      color: var(--accent);
      font-size: 0.6rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .card.locked .available-pill {
      display: none;
    }

    .card-back {
      background-size: 600% 400%; /* 6 kolumn, 4 wiersze */
      background-repeat: no-repeat;
      transform: rotateY(180deg);
      position: relative;
    }

    .card-back::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(
        to top,
        rgba(15, 23, 42, 0.9),
        rgba(15, 23, 42, 0.15)
      );
    }

    .back-content {
      position: absolute;
      inset: 0;
      padding: 6px;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      z-index: 1;
    }

    .back-day-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      opacity: 0.8;
      margin-bottom: 2px;
    }

    .back-message {
      font-size: 0.7rem;
      line-height: 1.2;
    }

    .card.is-open .card-front {
      border: 1px solid rgba(34, 197, 94, 0.7);
    }

    .status-bar {
      margin-top: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .progress {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .progress-pill {
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      font-size: 0.7rem;
    }

    .date-info {
      font-feature-settings: "tnum";
    }

    .wiggle {
      animation: wiggle 0.4s ease;
    }

    @keyframes wiggle {
      0% { transform: translateX(0); }
      25% { transform: translateX(-2px); }
      50% { transform: translateX(2px); }
      75% { transform: translateX(-2px); }
      100% { transform: translateX(0); }
    }
  </style>
</head>
<body>
  <main class="app">
    <header>
      <h1>Kalendarz adwentowy</h1>
      <p>Dotykaj okienek, kiedy przyjdzie ich grudniowy dzie≈Ñ. üéÑ</p>
    </header>

    <section class="calendar-wrapper">
      <div id="calendar" class="calendar-grid" aria-label="Kalendarz adwentowy"></div>

      <div class="status-bar">
        <div class="progress">
          <span id="progressText">0 / 24 otwartych</span>
          <span class="progress-pill" id="todayInfo"></span>
        </div>
        <span class="date-info" id="dateInfo"></span>
      </div>
    </section>
  </main>

  <script>
    // === USTAWIENIA DO PODMIANY ===

    // Tutaj podmie≈Ñ na swojƒÖ grafikƒô (mo≈ºe byƒá ≈õcie≈ºka wzglƒôdna w repo)
    const IMAGE_URL = "img/moje_zdjecie.jpg";

    // Wiadomo≈õci pod okienkami (pro tip: mo≈ºesz je potem wczytywaƒá z JSONa)
    const messages = [
      "Dzisiejsza misja: ma≈Çy u≈õmiech dla kogo≈õ obok.",
      "Wypij kubek czego≈õ ciep≈Çego i oddychaj g≈Çƒôboko.",
      "Zr√≥b jednƒÖ ma≈ÇƒÖ rzecz, kt√≥rƒÖ odk≈Çadasz od dawna.",
      "Powiedz komu≈õ bliskiemu co≈õ mi≈Çego ‚Äì konkretnie.",
      "5 minut totalnego resetu od telefonu.",
      "Napisz jednƒÖ rzecz, z kt√≥rej jeste≈õ dumna/dumny.",
      "Wy≈õlij g≈Çupawego mema do przyjaciela.",
      "Spacer choƒáby 10 minut ‚Äì serio.",
      "Pos≈Çuchaj swojej ulubionej piosenki z pe≈Çnym skupieniem.",
      "Zr√≥b komu≈õ niespodziewanƒÖ, drobnƒÖ przys≈Çugƒô.",
      "Daj sobie prawo dzi≈õ czego≈õ nie robiƒá.",
      "Zr√≥b porzƒÖdek w jednym ma≈Çym miejscu.",
      "Zapisz trzy rzeczy, za kt√≥re jeste≈õ wdziƒôczna/wdziƒôczny.",
      "Zr√≥b co≈õ kreatywnego przez 10 minut.",
      "Napisz wiadomo≈õƒá do kogo≈õ, z kim dawno nie gada≈Ça≈õ/gada≈Çe≈õ.",
      "Pomy≈õl, co dobrego zrobi≈Çe≈õ w tym roku.",
      "Zr√≥b przerwƒô na przeciƒÖganie i g≈Çƒôboki wdech.",
      "Zaplanuj jednƒÖ przyjemnƒÖ rzecz po sesji/pracy.",
      "Zr√≥b sobie ma≈Çy, symboliczny prezent.",
      "Wieczorem od≈Ç√≥≈º telefon na 30 minut.",
      "Zr√≥b screen tego okienka na pamiƒÖtkƒô üòâ",
      "Przytul kogo≈õ (albo poduszkƒô, te≈º siƒô liczy).",
      "Pomy≈õl, co chcia≈Çby≈õ zabraƒá ze sobƒÖ w nowy rok.",
      "Dziƒôkujƒô, ≈ºe dotar≈Ça≈õ/e≈õ do 24. ‚ù§Ô∏è"
    ];

    const ROWS = 4;
    const COLS = 6;
    const TOTAL_DAYS = 24;
    const STORAGE_KEY = "advent-calendar-opened-2025";

    function getCurrentDayForCalendar() {
      const now = new Date();

      // Domy≈õlnie blokujemy wszystko poza grudniem
      let day = 0;
      if (now.getMonth() === 11) {
        // grudzie≈Ñ (0 = stycze≈Ñ)
        day = Math.min(now.getDate(), TOTAL_DAYS);
      }

      // üëâ TRYB TESTOWY:
      // Mo≈ºesz w URL dodaƒá ?debugDay=10 ≈ºeby testowaƒá zachowanie kalendarza
      const params = new URLSearchParams(window.location.search);
      const debugDay = parseInt(params.get("debugDay"), 10);
      if (!isNaN(debugDay)) {
        return Math.max(0, Math.min(debugDay, TOTAL_DAYS));
      }

      return day;
    }

    function loadOpenedFromStorage() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return new Set();
        const arr = JSON.parse(raw);
        return new Set(arr);
      } catch (e) {
        return new Set();
      }
    }

    function saveOpenedToStorage(set) {
      const arr = Array.from(set);
      localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
    }

    function updateStatusBar(openedSet, currentDay) {
      const progressText = document.getElementById("progressText");
      const todayInfo = document.getElementById("todayInfo");
      const dateInfo = document.getElementById("dateInfo");

      progressText.textContent = `${openedSet.size} / ${TOTAL_DAYS} otwartych`;

      if (currentDay === 0) {
        todayInfo.textContent = "Odpalamy od 1 grudnia üéÅ";
      } else {
        todayInfo.textContent = `Dostƒôpne okienka: 1‚Äì${currentDay}`;
      }

      const now = new Date();
      const options = { day: "2-digit", month: "2-digit", year: "numeric" };
      dateInfo.textContent = now.toLocaleDateString("pl-PL", options);
    }

    function createCalendar() {
      const container = document.getElementById("calendar");
      const currentDay = getCurrentDayForCalendar();
      const openedSet = loadOpenedFromStorage();

      container.innerHTML = "";

      for (let i = 0; i < TOTAL_DAYS; i++) {
        const dayNumber = i + 1;
        const row = Math.floor(i / COLS);
        const col = i % COLS;

        const card = document.createElement("button");
        card.className = "card";
        card.setAttribute("type", "button");
        card.setAttribute("aria-label", `Okienko ${dayNumber}`);
        card.dataset.day = String(dayNumber);

        const cardInner = document.createElement("div");
        cardInner.className = "card-inner";

        // FRONT
        const front = document.createElement("div");
        front.className = "card-face card-front";

        const daySpan = document.createElement("span");
        daySpan.className = "day-number";
        daySpan.textContent = String(dayNumber);

        const label = document.createElement("span");
        label.className = "label";
        label.textContent = "Dotknij, aby odkryƒá";

        const availablePill = document.createElement("span");
        availablePill.className = "available-pill";
        availablePill.textContent = "Dostƒôpne";

        front.appendChild(daySpan);
        front.appendChild(label);
        front.appendChild(availablePill);

        // BACK
        const back = document.createElement("div");
        back.className = "card-face card-back";
        back.style.backgroundImage = `url('${IMAGE_URL}')`;

        const xPos = (col / (COLS - 1)) * 100;
        const yPos = (row / (ROWS - 1)) * 100;
        back.style.backgroundPosition = `${xPos}% ${yPos}%`;

        const backContent = document.createElement("div");
        backContent.className = "back-content";

        const backDayLabel = document.createElement("div");
        backDayLabel.className = "back-day-label";
        backDayLabel.textContent = `${dayNumber}. grudnia`;

        const backMessage = document.createElement("div");
        backMessage.className = "back-message";
        backMessage.textContent = messages[i] || "";

        backContent.appendChild(backDayLabel);
        backContent.appendChild(backMessage);
        back.appendChild(backContent);

        cardInner.appendChild(front);
        cardInner.appendChild(back);
        card.appendChild(cardInner);
        container.appendChild(card);

        const alreadyOpen = openedSet.has(dayNumber);
        if (alreadyOpen) {
          card.classList.add("is-open");
        }

        const isLocked = dayNumber > currentDay;
        if (isLocked) {
          card.classList.add("locked");
        }

        card.addEventListener("click", () => {
          const nowDay = getCurrentDayForCalendar();
          if (dayNumber > nowDay) {
            // Lekki ‚Äûwiggle‚Äù ≈ºeby pokazaƒá, ≈ºe zablokowane
            card.classList.remove("wiggle");
            void card.offsetWidth; // force reflow
            card.classList.add("wiggle");
            return;
          }

          if (card.classList.contains("is-open")) {
            // Mo≈ºemy zostawiƒá jako one-way: jak otwarte, to otwarte :)
            return;
          }

          card.classList.add("is-open");
          openedSet.add(dayNumber);
          saveOpenedToStorage(openedSet);
          updateStatusBar(openedSet, nowDay);
        });
      }

      updateStatusBar(openedSet, currentDay);
    }

    createCalendar();
  </script>
</body>
</html>
